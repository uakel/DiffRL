Overwriting xml settings with: {'opt.integrator': 'Diffrax', 'opt.dfx_approximate_integration': False, 'opt.dfx_max_ode_steps': 256, 'opt.dfx_solver': 'Tsit5', 'opt.dfx_stepsize_controller': 'PID', 'opt.dfx_pid_atol': 0.01, 'opt.dfx_pid_rtol': 0.01, 'opt.dfx_adjoint': 'RecursiveCheckpoint', 'opt.dfx_recursive_ncheckpoints': None, 'opt.dfx_pid_dt0': None, 'opt.cfd_enable': True, 'opt.cfd_solimp': [0.0, 0.01, 0.05, 1.0, 2.0], 'opt.col_soft_enable': False, 'opt.timestep': 0.0025, 'opt.iterations': 4, 'opt.ls_iterations': 16}
New MJX opt settings: Option(timestep=Array(0.0025, dtype=float64), apirate=Array(100., dtype=float64), impratio=Array(1., dtype=float64), tolerance=Array(1.e-08, dtype=float64), ls_tolerance=Array(0.01, dtype=float64), noslip_tolerance=Array(1.e-06, dtype=float64), ccd_tolerance=Array(1.e-06, dtype=float64), gravity=Array([ 0.  ,  0.  , -9.81], dtype=float64), wind=Array([0., 0., 0.], dtype=float64), magnetic=Array([ 0. , -0.5,  0. ], dtype=float64), density=Array(0., dtype=float64), viscosity=Array(0., dtype=float64), o_margin=Array(0., dtype=float64), o_solref=Array([0.02, 1.  ], dtype=float64), o_solimp=Array([9.0e-01, 9.5e-01, 1.0e-03, 5.0e-01, 2.0e+00], dtype=float64), o_friction=Array([1.e+00, 1.e+00, 5.e-03, 1.e-04, 1.e-04], dtype=float64), has_fluid_params=np.False_, integrator='Diffrax', cone=<ConeType.PYRAMIDAL: 0>, jacobian=<JacobianType.AUTO: 2>, solver=<SolverType.NEWTON: 2>, iterations=4, ls_iterations=16, noslip_iterations=0, ccd_iterations=50, disableflags=<DisableBit.0: 0>, enableflags=<EnableBit.0: 0>, disableactuator=0, sdf_initpoints=40, sdf_iterations=10, dfx_max_ode_steps=256, dfx_approximate_integration=False, dfx_exact_use_semiimplicit=None, dfx_solver='Tsit5', dfx_stepsize_controller='PID', dfx_pid_dt0=None, dfx_pid_rtol=Array(0.01, dtype=float64), dfx_pid_atol=Array(0.01, dtype=float64), dfx_adjoint='RecursiveCheckpoint', dfx_recursive_ncheckpoints=None, dfx_backsolve_solver=None, dfx_backsolve_stepsize_controller=None, dfx_backsolve_pid_rtol=None, dfx_backsolve_pid_atol=None, col_soft_enable=False, cfd_enable=True, cfd_solimp=[Array(0., dtype=float64), Array(0.01, dtype=float64), Array(0.05, dtype=float64), Array(1., dtype=float64), Array(2., dtype=float64)])
Traceback (most recent call last):
  File "/home/franzleo/Projects/DiffRL/packages/diffmjx-mjpc/diffmjx_mjpc/main.py", line 172, in <module>
    main()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/franzleo/Projects/DiffRL/packages/diffmjx-mjpc/diffmjx_mjpc/main.py", line 161, in main
    d = mjx.kinematics(m, d)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/smooth.py", line 125, in kinematics
    site_xpos, site_xmat = v_local_to_global(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/api.py", line 1015, in vmap_f
    out_flat = batching.batch(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 210, in call_wrapped
    return self.f_transformed(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 604, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 619, in _batch_inner
    outs = f(*in_tracers)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 339, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 370, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/support.py", line 192, in local_to_global
    pos = world_pos + math.rotate(local_pos, world_quat)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/math.py", line 119, in rotate
    r = r + 2 * s * jp.cross(u, vec)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 341, in cache_miss
    pgle_profiler) = _python_pjit_helper(fun, jit_info, *args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 197, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **p.params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 502, in bind
    return self._true_bind(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 520, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 525, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 488, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1964, in _pjit_batcher
    vals_out = pjit_p.bind(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 502, in bind
    return self._true_bind(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 520, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 525, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 1024, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1724, in _pjit_call_impl
    return xc._xla.pjit(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1700, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1657, in _pjit_call_impl_python
    ).compile()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2446, in compile
    executable = UnloadedMeshExecutable.from_hlo(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2959, in from_hlo
    xla_executable = _cached_compilation(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2757, in _cached_compilation
    xla_executable = compiler.compile_or_get_cached(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 473, in compile_or_get_cached
    return _compile_and_write_cache(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 690, in _compile_and_write_cache
    executable = backend_compile(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/profiler.py", line 334, in wrapper
    return func(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 324, in backend_compile
    return backend.compile(built_c, compile_options=options)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/franzleo/Projects/DiffRL/packages/diffmjx-mjpc/diffmjx_mjpc/main.py", line 172, in <module>
    main()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/franzleo/Projects/DiffRL/packages/diffmjx-mjpc/diffmjx_mjpc/main.py", line 161, in main
    d = mjx.kinematics(m, d)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/smooth.py", line 125, in kinematics
    site_xpos, site_xmat = v_local_to_global(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/api.py", line 1015, in vmap_f
    out_flat = batching.batch(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 210, in call_wrapped
    return self.f_transformed(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 604, in _batch_outer
    outs, trace = f(tag, in_dims, *in_vals)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 619, in _batch_inner
    outs = f(*in_tracers)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 339, in flatten_fun_for_vmap
    ans = f(*py_args, **py_kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 370, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/support.py", line 192, in local_to_global
    pos = world_pos + math.rotate(local_pos, world_quat)
  File "/home/franzleo/Projects/DiffRL/packages/mujoco/mjx/mujoco/mjx/_src/math.py", line 119, in rotate
    r = r + 2 * s * jp.cross(u, vec)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 341, in cache_miss
    pgle_profiler) = _python_pjit_helper(fun, jit_info, *args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 197, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **p.params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 502, in bind
    return self._true_bind(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 520, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 525, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/batching.py", line 488, in process_primitive
    val_out, dim_out = fancy_primitive_batchers[p](
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1964, in _pjit_batcher
    vals_out = pjit_p.bind(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 502, in bind
    return self._true_bind(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 520, in _true_bind
    return self.bind_with_trace(prev_trace, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 525, in bind_with_trace
    return trace.process_primitive(self, args, params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/core.py", line 1024, in process_primitive
    return primitive.impl(*args, **params)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1724, in _pjit_call_impl
    return xc._xla.pjit(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1700, in call_impl_cache_miss
    out_flat, compiled, pgle_profiler = _pjit_call_impl_python(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/pjit.py", line 1657, in _pjit_call_impl_python
    ).compile()
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2446, in compile
    executable = UnloadedMeshExecutable.from_hlo(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2959, in from_hlo
    xla_executable = _cached_compilation(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2757, in _cached_compilation
    xla_executable = compiler.compile_or_get_cached(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 473, in compile_or_get_cached
    return _compile_and_write_cache(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 690, in _compile_and_write_cache
    executable = backend_compile(
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/profiler.py", line 334, in wrapper
    return func(*args, **kwargs)
  File "/home/franzleo/Projects/DiffRL/.venv/lib/python3.10/site-packages/jax/_src/compiler.py", line 324, in backend_compile
    return backend.compile(built_c, compile_options=options)
KeyboardInterrupt
